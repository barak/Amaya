<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
  <title>Redland RDF Application Framework - Release Notes</title>
  <style type="text/css">
<!--
pre
{
	margin: 1em 4em 1em 4em;
	background-color: #eee;
	padding: 0.5em;
	border-color: #006;
	border-width: 1px;
	border-style: dotted;
}
-->
  </style>
</head>
<body>

  <h1>Redland RDF Application Framework - Release Notes</h1>

<h2 id="rel0_9_16"><a name="rel0_9_16">Redland 0.9.16 Changes</a></h2>

<p>A small but important fix to make the installed C headers work
correctly again.  The rdf_uri.h file had <code>#include
rdf_digest.h</code> which is an internal header and not installed.
This required removing two functions from the public API that
returned <code>librdf_digest*</code>, but neither of them could be
used since rdf_digest.h was not shipped.</p>

<p>Patched librdf.h and raptor.h to <code>#include stdio.h</code> so
that the empty program <code>#include &lt;redland.h&gt;</code>
<code>main() {}</code> now works (ditto for raptor). </p>


<h2 id="rel0_9_15"><a name="rel0_9_15">Redland 0.9.15 Changes</a></h2>

<p>This version of Redland updates to use
<a href="http://www.redland.opensource.ac.uk/raptor/">Raptor</a>
1.2.0 (<a href="http://www.redland.opensource.ac.uk/raptor/NEWS.html">raptor news</a>)
along with the new syntax
<a href="http://www.ilrt.bris.ac.uk/discovery/2004/01/turtle/">Turtle Terse RDF Triple Language</a>.
</p>

<p>Three new storage modules were added:</p>
<ol>
<li><a href="http://www.mysql.com/">MySQL</a> store written by <a href="http://purl.org/net/morten/">Morten Frederiksen</a> supporting the entire storage API include full contexts support.</li>
<li><a href="http://triplestore.aktors.org/">AKT Triplestore</a> using MySQL inside 3store</li>
<li>File and URI-backed in-memory store - read/write file, read only URI.</li>
</ol>

<p>The details of these modules are explained in much greater detail
in the <a href="docs/storage.html">storage modules overview</a>
including the features that they support.
</p>

<p>The runtime is now compiled with assertions to check for illegal
use of NULL pointers in arguments, these will give warning messages
(which can be disabled with <code>--disable-assert-messages</code>).
The storage and model classes now track when open iterator and
streams are operating on them and will not release resources until
all the open iterators and streams are finished.
</p>


<h3>URI and Literal string type changes</h3>

<p>There are many changes are to properly use and return UTF-8
strings as <code>unsigned char*</code> for URIs (looking forward to
Internationalized Resource Identifiers, IRIs emerging) and for RDF
literal strings, plus other fixes to work better with C++ correcting
the use of <code>const</code>.  Redland and Raptor now both compile
cleanly with g++ 3.2, 3.3 and all warnings enabled.</p>


<h3><code>rdfproc</code> RDF processor utility program changes</h3>

<p><a href="utils/rdfproc.html">rdfproc</a> was extensively updated
and it can now more easily work with any type of Redland store and
has better support for working with contexts. The detailed changes
are as follows:</p>

<ul>
<li>Added an -s TYPE option to specify a storage type</li>
<li>Added an -t option for giving storage options</li>
<li>Added an -p option to read the value of
storage option <code>password</code> from standard input, to prevent
exposing it as a parameter.</li>
<li>The default of creating a new store was
replaced; -n enables truncation or overwriting (the
<code>write=yes</code> storage option).</li>
<li> Now recognises <code>_:</code><em>abc</em> as blank node arguments.</li>
<li>Parsing now return counts of errors and warnings if possible.</li>
<li>The parse-stream command can take an optional context node</li>
<li>Added a contexts command, to list the contexts in a model.</li>
<li>Added support for environment variables RDFPROC_STORAGE_OPTIONS and
RDFPROC_STORAGE_TYPE to provide default storage options (-t) and type (-s)</li>
<li>Help message updated and correctly lists supported parsers</li>
</ul>


<h3>Configuration changes</h3>

<p>Redland 0.9.15 requires Raptor 1.2.0 either installed otherwise
the copy in the source tree will be installed.</p>

<p><code>--with-mysql=</code><em>CONFIG</em> added to point to the
mysql_config program for the MySQL backing store
</p>

<p><code>--with-threestore</code> added to enable the
AKT Triplestore
</p>

<p><code>--disable-assert</code> added to disable
compiling run-time assertions.
</p>

<p><code>--disable-assert-messages</code> added to disable
compiling run-time assertion messages.
</p>


<h3>Packaging changes</h3>

<p>A redland-python RPM package is now provided and the default RPM
packaging now provides the MySQL store, in addition to the in-memory
and BDB previously packaged.  The new file and uri stores are also
available.  The full list of store modules is described further in the
<a href="docs/storage.html">storage modules overview</a>.</p>


<h3>Model Class changes</h3>

<p>Methods
<code>librdf_model_add_string_literal_statement</code> and
<code>librdf_model_add_typed_literal_statement</code>
now take a <code>const unsigned char* string</code>.
Method
<code>librdf_model_query_string</code> now takes
a <code>const unsigned char* string</code> query.
</p>

<p>New methods were added
<code>librdf_model_find_statements_in_context</code>
to search for a statement matching only in a particular context,
<code>librdf_model_find_statements_with_options</code> to
allow options with searching (none used at present),
and <code>librdf_model_get_contexts</code> to
list the context nodes in a graph.
</p>

<p>Methods <code>librdf_model_get_feature</code>,
<code>librdf_model_set_feature</code> were modified to take and return
<code>librdf_node*</code> values.
</p>


<h3>Node Class changes</h3>

<p>Constructors
<code>librdf_new_node_from_uri_string</code>,
<code>librdf_new_node_from_uri_local_name</code> and
<code>librdf_new_node_from_normalised_uri_string</code>
now take a <code>const unsigned char*
string</code> URI string.
Constructors
<code>librdf_new_node_from_literal</code> and
<code>librdf_new_node_from_typed_literal</code>
now take a <code>const unsigned char* string</code> RDF literal.
Constructor <code>librdf_new_node_from_blank_identifier</code>
now takes a <code>const unsigned char* string</code> blank node identifier.
</p>

<p>Methods
<code>librdf_node_get_literal_value</code>,
<code>librdf_node_get_literal_value_as_counted_string</code> and
<code>librdf_node_get_blank_identifier</code>
now return a <code>const unsigned char* string</code> RDF literal,
blank node identifier

</p>

<p>(Debugging methods <code>librdf_node_to_string</code> and
<code>librdf_node_to_counted_string</code>where changed to return a
<code>const unsigned char* string</code>)
</p>


<h3>Parser Class changes</h3>

<p>Methods
<code>librdf_parser_parse_string_as_stream</code> and
<code>librdf_parser_parse_string_into_model</code>
now take a <code>const unsigned char* string</code> syntax buffer.
</p>

<p>Methods
<code>librdf_parser_get_feature</code>
and <code>librdf_parser_set_feature</code>
were modified to take and return <code>librdf_node*</code> values.
</p>


<h3>Query Class changes</h3>

<p>Constructor <code>librdf_new_query</code> now takes a <code>const
unsigned char* string</code> query.
</p>




<h3>Serializer Class changes</h3>

<p>Added methods <code>librdf_serializer_get_feature</code> and
<code>librdf_serializer_set_feature</code> taking and returning
<code>librdf_node*</code> values like the methods for the model and
parser classes.
</p>


<h3>Statement Class changes</h3>

<p>(Debugging method <code>librdf_statement_to_string</code> now
returns a <code>const unsigned char* string</code>)
</p>


<h3>URI Class changes</h3>

<p>Constructors
<code>librdf_new_uri</code>, 
<code>librdf_new_uri_from_uri_local_name</code>,
<code>librdf_new_uri_normalised_to_base</code> and
<code>librdf_new_uri_relative_to_base</code>.
now take a <code>const unsigned char* string</code> URI string.
</p>

<p>Methods
<code>librdf_uri_as_string</code>,
<code>librdf_uri_as_counted_string</code>,
<code>librdf_uri_to_string</code> and
<code>librdf_uri_to_counted_string</code>
now return a <code>const unsigned char* string</code> URI string.
</p>


<h3>Java API Changes</h3>

<p>Updated to match API changes above.  Fixes for OSX 10.3</p>

<h3>Perl API changes</h3>

<p>Updated to match API changes above.  Fixes for perl 5.8.1 and
later which changed how <code>MakeMaker</code> installed.  Let perl
install the files rather than try to force it based on the prefix
argument to configure.  Make Parser method parse_string_into_model
call the correct Redland function.  Added OSX Java directories
to JDK search path.</p>


<h3>PHP API Changes</h3>

<p>Updated to match API changes above.  Redland is now started up and
shutdown once in the PHP module code and does not need to called
directly.</p>


<h3>Python API changes</h3>

<p>Updated to match API changes above.  Fix Node literal_values
to work with datatype URIs.  Export the NS class.  Added
a FileStorage class for the storage type <code>file</code>.
Removed use of the python Distutils which was often
getting the linking wrong.
</p>

<h3>Ruby API changes</h3>

<p>Updated to match API changes above.</p>

<h3>Tcl API changes</h3>

<p>Updated to match API changes above.</p>


<h3>Other changes</h3>

<p>Redland now ships with both portable MD5 as well as (new in
0.9.15) SHA1 digest implementations used if neither is available via
an optimised library.</p>


<h2 id="rel0_9_14"><a name="rel0_9_14">Redland 0.9.14 Changes</a></h2>

<p>This version of Redland is an update mostly to synchronise
with the 
<a href="http://www.redland.opensource.ac.uk/raptor/">Raptor</a> version 1.0.0 (RDF/XML and N-Triples parser) - see
<a href="http://www.redland.opensource.ac.uk/raptor/NEWS.html">Raptor NEWS</a>
for the changes since 0.9.12.</p>

<p>New in this version is the <a href="utils/rdfproc.html">rdfproc</a> utility
which allows command line creation of redland stores, parsing
of syntaxes and manipulation of the model.</p>


<h3>Configuration changes</h3>

<p>Added <code>--with-raptor</code> to either choose the system
or internal raptor library.  If omittted, redland will guess
and choose either the system one, if new enough or the internal
one (always present).</p>


<h3>Hash Class changes</h3>

<p>Added a <code>librdf_hash_put_strings</code> helper method to put a pair of
string values into a hash.  Useful for making model or storage
options.</p>

<h3>Node Class changes</h3>

<p>Resource (URI) / literal / blank nodes are now interned on
construction so there is only one object for each distinct
<code>librdf_node</code> object. This reduces memory and makes
copying cheaper at the cost of an increase in construction cost.
Copying nodes is very common, since not only is it done for nodes but
any time a statement is used or returned.  This interning was already
done for the URI class but the change required
<code>librdf_node</code> to be made immutable, which was done in
0.9.13.</p>

<h3>Storage Class changes</h3>

<p>Added <code>librdf_storage_context_as_stream</code> deprecating
<code>librdf_storage_context_serialise</code> to be consistent with the
*as_stream method name changes to model.</p>

<p>Added <code>librdf_new_storage_with_options</code> taking an
<code>librdf_hash*</code>
of options rather than the string of <code>librdf_new_storage</code>.</p>

<p>Added new optional storage factory methods context_add_statements
and context_remove_statements.  If omitted, the storage class
implements them with context_add_statement and context_remove_statement.</p>


<h3>Stream and Iterator Classes changes</h3>

<p>Optimised the stream and iterator internals to do less factory
method calls when looking for new items or the end of
stream/iterator.  This should make them slightly faster.</p>


<h3>Miscellaneous changes</h3>

<p>Renamed Redland statics to be <code>librdf_*</code> rather than
<code>redland_*</code>.  Added a one-line
librdf_short_copyright_string.</p>


<h3>Perl API Changes</h3>

<p>Fixed the broken use of <tt>UNIVERSAL::isa</tt></p>



<h2 id="rel0_9_13"><a name="rel0_9_13">Redland 0.9.13 Changes</a></h2>

<p>This version of Redland is a major update to 0.9.12 changing the
node class.  <code>librdf_node</code> objects are now immutable once created,
higher-level language APIs no longer have deal with sharing or
copying internals, some additional API support for parsing content
from strings.</p>

<p>This includes the stable and complete version 0.9.12 of the 
<a href="http://www.redland.opensource.ac.uk/raptor/">Raptor parser</a>
which supports all of the revised RDF/XML syntax.</p>

<p>Initial work was added on an ECMA CLI interface using
the C# ("C sharp") language.</p>

<p>Blank nodes generated by parsing the syntaxes are now
generated more unique (not guaranteed) based on the Redland
startup time and a serial number.</p>

<p>The Perl, Python and Java APIs now always return new nodes
and statements removing the need to consider sharing at this
level.  This means that the following operation is legal in
Perl, Python and Java:</p>
<pre>
# perl
$n=RDF::Redland::Node->from_uri("http://example.org/foo");
$s=new RDF::Redland::Statement($n, $n, $n);
$model->add($s);

# python
n=RDF.Uri("http://example.org/foo")
s=RDF.Statement(n, n, n) # n is used as a resource RDF.Node here
model.add_statement(s)
</pre>

<h3>Configuration</h3>

<p>Several improvements were made to the building and configuring
including a better attempt to find matching Sleepycat/Berkeley DB
header and library files (and support BDB up to 4.1), searching for
installed Java JDKs and Tcl headers.  Each of the language interfaces
can be individually enabled to be build, tested and installed with
the main C library.</p>


<h3>Node Class changes</h3>

<p>The <code>librdf_node</code> class was modifed to make objects
immutable once constructed, they cannot be modified.  The following
set methods were consequently removed.</p>

<ul>
<li><code>librdf_node_set_blank_identifier</code></li>
<li><code>librdf_node_set_li_ordinal</code></li>
<li><code>librdf_node_set_literal_value</code></li>
<li><code>librdf_node_set_type</code></li>
<li><code>librdf_node_set_typed_literal_value</code></li>
<li><code>librdf_node_set_uri</code></li>
</ul>

<p>The following utility methods were added (covering
all the <code>librdf_node_get_type</code> values):</p>

<ul>
<li><code>librdf_node_is_blank</code> - return non-0 if the node is a blank node</li>
<li><code>librdf_node_is_literal</code> - return non-0 if the node is a literal</li>
<li><code>librdf_node_is_resource</code> - return non-0 if the node is a URI</li>
</ul>

<p>(These are reflected into the same methods on
the Perl, Python and Java node classes)</p>

<p><code>LIBRDF_NODE_TYPE_LI</code> as returned by <code>librdf_node_get_type</code>
was deleted, it was never used.</p>

<p>To support datatyped literals, the following method was added:</p>

<ul>
<li>librdf_node_get_literal_value_datatype_uri - get the typed literal datatype URI of the literal node</li>
</ul>


<h3>Model Class changes</h3>

<p>Added <code>ibrdf_model_sync</code> to sync the model to the backing store.</p>

<p>Added <code>librdf_model_as_stream</code> and
<code>librdf_model_context_as_stream</code> to replace
<code>librdf_model_context_serialise</code> and
<code>librdf_model_context_serialize</code> respectively.  This was
done both to reduce the confusion with the
<code>librdf_serializer</code> class and the mixture of US/UK
spelling of that word.  The old functions will remain for now.
</p>



<h3>Parser Class changes</h3>

<p>Added <code>librdf_parser_parse_string_as_stream</code> and
<code>librdf_parser_parse_string_into_model</code> to allow parsing
content from strings.</p>


<h3>Statement Class changes</h3>

<p>Added <code>librdf_statement_is_complete</code> to test if a
statement has all the subject, predicate and object fields assigned.
Partial statements cannot be added to a model but can be used in
matching statement queries with
<code>librdf_model_find_statements</code>.</p>


<h3>Storage Class changes</h3>

<p>Added <code>librdf_storage_sync</code> to sync the backing store.
(This is slightly internal to Redland, you should not be calling this
directly)</p>


<h3>Perl Interface Changes</h3>

<p>Updated to make the object constructors less verbose and to allow
Redland URI objects and native perl URIs to be used in place of
Redland Nodes where convienent (such as in making Statements).  All
existing code should work but can be shortened.
A new <code>--with-perl</code> configure argument to enable the perl
interface.
</p>


<h3>Python API changes</h3>

<p>A major update to use Python 2.2+ idioms and features by Edd
Dumbill with help from Matt Biddulph for unit tests.  A new
<code>--with-python</code> configure argument to enable the python
interface.  Edd wrote the following change log.</p>

<p>General changes</p>
<ul>
  <li>Removed string exceptions and replaced with RedlandError ones</li>
  <li>Where underlying Redland C objects were unexpectedly null, raise
    exceptions rather than returning None, "" or [] as appropriate.</li>
  <li>Raise exceptions if Redland C constructors fail in Python
    constructors.</li>
  <li>Did quite a lot of documentation updating, where possible
    demonstrating preferred Pythonic usages.</li>
  <li>Added more unit tests to test changed functionality.</li>
</ul>

<h4>RDF.Node class</h4>
<ul>
  <li>Constructor now accepts Uri to make a resource/property node, or
    a string to make a string literal</li>
  <li>Removed usage of node_type() in favour of is_resource(), is_blank()
    etc methods.</li>
  <li><strong>DEPRECATED</strong> get_blank_identifier() etc. methods in favour of
    node.blank_identifier etc properties.  Raise exception if properties
    inconsistent with the node type are requested.</li>
</ul>

<h4>RDF.Statement class</h4>
<ul>
  <li>No need to name subject, predicate, object in constructor any more.
    Uris or string literals accepted in place of nodes in constructor
    argument.</li>
  <li>__getattr__ method deleted, using new-style property() for
    subject, predicate, object</li>
</ul>

<h4>RDF.Model class</h4>

<ul>
  <li>Deleted get_*_iterator methods</li>
  <li>Renamed sources() to get_sources(), targets() to get_targets(),
    arcs() to get_predicates().  Retained old method names as aliases.</li>
  <li>Added get_sources_context(), get_targets_context(),
    get_predicates_context() which return (node, context) tuples.</li>
  <li>Amended get_source(), get_sources() etc methods so that Uri and
    string literals were acceptable as shortcut types for nodes.</li>
  <li>Added find_statements_context() which returns (statement, context)
    tuples.</li>
  <li>Renamed context_remove_statements() to
    remove_statements_with_context(). Retained old method name as an
    alias.</li>
  <li>Added __delitem__ method so del[statement] and del[statement,
    context] work.</li>
  <li>Added append() method so append(statement) and append(statement,
    context) work.  Suggest that append() is used in preference to
    add_statement() for Python idiomatic usage.</li>
  <li><strong>DEPRECATED</strong> serialise() in favour of as_stream().</li>
  <li>Added as_stream_context() to serialise (statement, context) tuples.</li>
  <li>Exception raised if len() is attempted on model with a non-countable
    storage.</li>
  <li><strong>DEPRECATED</strong> Model.add(), Model.add_typed_literal_statement() usages:
    now that constructing Statements is easier, it's incongruous to have
    these in the model.  Additionally it saves reproducing various bits
    of error checking that properly belong in the Node() constructor.</li>
  <li>Implemented __contains__() so "if statement in model" and
    "if (statement, context) in model" work as expected using the more
    efficient Redland C methods where possible.</li>
</ul>

<h4>RDF.Stream class</h4>

<ul>
  <li><strong>DEPRECATED</strong> Stream.context_iter().  Use in preference the _context
    variants of the appropriate Model methods.  This leads to fewer
    lines of code.</li>
</ul>

<h4>RDF.Uri class</h4>

<ul>
  <li>Amended constructor so strings or Uri instances can be passed as
    the first argument, without named parameters being required, and
    the right thing still happen.</li>
</ul>


<h3>Java Interface Changes</h3>

<p>Additions for the new API calls as outlined above (such
as model/storage sync, parsing from strings etc.). New configure
argument <code>--with-jdk</code> to pick the JDK in order to
find the JNI headers.  See the <a href="docs/java.html">java API</a>
page for details.</p>


<h3>PHP, Ruby and Tcl Interfaces Changes</h3>

<p>Updates in configuring and building these interfaces and new
<code>--with-php</code>, <code>--with-ruby</code> and <code>--with-tcl</code>
configure arguments.  See the corresponding API pages and
installation documentation for details.  Tcl now tries to guess the
includes directories.</p>


<h3>Internal changes and fixes</h3>

<ul>
<li>Added Sleepycat/BDB 4.0 and 4.1 support - the open API changed again</li>

<li>Split the <code>librdf_model</code> class into model interface
(<code>librdf_model</code>) and implementation class
(<code>librdf_model_storage</code>).</li>

<li>Removed the old and outdated repat RDF parser.</li>

<li>Removed the very old expat XML parser from the sources;
much newer or expat or libxml2 are very widespread.</li>

<li>Added simple thread support from patches by Seth Ladd with
configuration option <code>--with-threads</code> that locks key shared
classes to allow separate threads to work in the same memory
space. The current locked classes are URI and World.</li>

<li>Deleting statements in the in-memory store now works.</li>

<li>Getting the context of iterators returned from in-memory
sources, targets, arcs now works.</li>

</ul>


<h2 id="rel0_9_12"><a name="rel0_9_12">Redland 0.9.12 Changes</a></h2>

<p>This version of Redland is a major update to 0.9.11 incorporating
a much more improved, complete and stable version 0.9.7 of the 
<a href="http://www.redland.opensource.ac.uk/raptor/">Raptor parser</a>
and a significant new feature, contexts.  The
high-level language APIs received some updates and the start of two
new languages APIs were added: <a href="docs/ruby.html">Ruby</a> and
<a href="docs/php.html">PHP</a>.</p>

<p>Several incompatible API changes were made in this release that
effect the C interface and all the higher level language APIs.  These
were made to support contexts and to fix some inconsistencies in the
interface about object ownership.</p>

<p>The persistent storage format was changed to support RDF typed
literals and this requires an upgrade of any existing
Berkeley/Sleepycat DB stores created by Redland 0.9.11 or earlier.  A
utility <em>redland-db-upgrade</em> is provided that will create an
updated store from an existing one.</p>

<p>A Perl script <a href="utils/update-api-0912.pl">utils/update-api-0912.pl</a>
can help automate the API changes as far as possible or warn about those
that cannot be automatically updated.</p>


<h3>New Feature - Contexts</h3>

<p>This feature allows a Node to be given whenever a statement is
added to a model which can can be retrieved from any model query that
returns answers as an Iterator of Nodes or a Stream of Statements.
Both of these classes gained a new method <code>get_context</code>
that returns the original Node that was given when the statement
corresponding to the answer was added to the model.</p>

<p>The context node can also be used to add and remove sets of
statements to/from a model, and each statement with a given
context node can be listed as a stream of statements.</p>

<p>Adding this feature required substantial internal changes to these
two classes and the internal storage apis and implementations along
with moderate code changes at the application level, which are
described below.</p>

<p>This feature can be used for the following (not an exhaustive list):</p>

<ul>
<li>Enable true graph merging / updating / demerging - identify the
subgraphs with context nodes.</li>
<li>Statement Identity - add each statement with a different context node</li>
<li>Statement Provenance - use the context node as the subject of
other statements about the statement that is returned.</li>
</ul>


<h3>Iterator Class Changes</h3>

<p>The <a href="docs/api/iterator.html">Iterator</a>
<code>get_next</code> method was split into <code>get_object</code>
always returning a pointer to a shared object and the
<code>next</code> method to advance the iterator.
The <code>get_object</code> method is generally called
<code>current</code> in the higher level language APIs.</p>

<p>(Iterator and Stream now have consistent method names; they
may be merged in future.)</p>

<p>The <code>get_object</code> method now always returns a pointer to
a shared object.  If this object is needed outside the scope of an
iteration, it must be copied, which for Nodes is the copy constructor
<code>librdf_new_node_from_node</code>.</p>

<p>C example for Redland 0.9.11 and earlier:</p>
<pre>
  while(!librdf_iterator_end(iterator)) {
    node=(librdf_node*)librdf_iterator_get_next(iterator);
    /* do something with the node */
  }
</pre>

<p>Redland 0.9.12:</p>
<pre>
  while(!librdf_iterator_end(iterator)) {
    node=(librdf_node*)librdf_iterator_get_object(iterator);
    /* do something with the node */
    librdf_iterator_next(iterator);
  }
</pre>

<p>A new method <code>get_context</code> was added returning a Node
for the context of the original Statement that generated the Iterator
Node.</p>

<p>C Iterator context example:</p>
<pre>
  while(!librdf_iterator_end(iterator)) {
    node=(librdf_node*)librdf_iterator_get_object(iterator);
    context_node=(librdf_node*)librdf_iterator_get_context(iterator);
    /* do something with the node and its context */
    librdf_iterator_next(iterator);
  }
</pre>



<h3>Model Class Changes</h3>

<p>The <a href="docs/api/model.html">Model</a>
<code>add_statement</code> method no longer takes ownership of the
passed in statement object.  The caller now retains ownership and can
reuse the statement several times and has responsibility for freeing it
if need be (when it isn't shared).</p>

<p>C example for Redland 0.9.11 and earlier:</p>
<pre>
  librdf_model_add_statement(model, statement);
</pre>

<p>Redland 0.9.12:</p>
<pre>
  librdf_model_add_statement(model, statement);
  librdf_free_statement(statement);
</pre>


<p>C streaming statement example for Redland 0.9.11 and earlier:</p>
<pre>
  while(!librdf_stream_end(stream)) {
    librdf_statement *statement=librdf_stream_next(stream); 
    /* This statement is new, so could be added directly */
    librdf_model_add_statement(model, statement);
  }
</pre>

<p>Redland 0.9.12:</p>
<pre>
  while(!librdf_stream_end(stream)) {
    librdf_statement *statement=librdf_stream_get_object(stream); 
    /* This statement is now shared so can still be just added */
    librdf_model_add_statement(model, statement);
  }
</pre>


<p><code>librdf_model_add_string_literal_statement</code> lost the
xml_space argument.</p>

<p>A new method was added to add a Statement with
an RDF datatyped literals object:</p>
<pre>
  int librdf_model_add_typed_literal_statement(librdf_model* model,
     librdf_node* subject, 
     librdf_node* predicate, 
     char* string, char *xml_language, librdf_uri *datatype_uri);
</pre>

<p>This should be used in preference to
<code>librdf_model_add_string_literal_statement</code> which remains
in the API as a wrapper around the above.</p>

<p>New methods were added to add, remove and list Statements to contexts.</p>

<pre>
  /* Add a single statement to the model with context */
  int librdf_model_context_add_statement(librdf_model* model,
    librdf_node* context, librdf_statement* statement);

  /* Add all statements on the stream to the model with context */
  int librdf_model_context_add_statements(librdf_model* model, 
    librdf_node* context, librdf_stream* stream);

  /* Remove a single statement from the model with the given context */
  int librdf_model_context_remove_statement(librdf_model* model, 
    librdf_node* context, librdf_statement* statement);

  /* Remove all statements from the model with given context */
  int librdf_model_context_remove_statements(librdf_model* model, 
    librdf_node* context);

  /* List all statements in the model with the given context */
  librdf_stream* librdf_model_context_serialize(librdf_model* model, 
    librdf_node* context);
</pre>


<h3>Node Class Changes</h3>

<p>The <a href="docs/api/node.html">Node</a> class gained a new constructor:</p>
<pre>
  librdf_node* librdf_new_node_from_typed_literal(
    librdf_world *world,
    const char *string,
    const char *xml_language, 
    librdf_uri* datatype_uri);
</pre>

<p>that should be used in preference to
<code>librdf_new_node_from_literal</code> which remains in the API as
a wrapper around the above.  </p>

<p><code>librdf_node_new_nodefrom_literal</code> lost the
xml_space argument.</p>


<h3>Parser Class Changes</h3>

<p>The <a href="docs/api/parser.html">Parser</a> class has an updated
<a href="http://www.redland.opensource.ac.uk/raptor/">Raptor parser</a>
version 0.9.7 - parsers named <code>raptor</code> for RDF/XML
(MIME Type <code>application/rdf+xml</code>)
and <code>ntriples</code> for N-Triples.  See the
<a href="http://www.redland.opensource.ac.uk/raptor/NEWS.html">Raptor NEWS</a>
for the detailed changes since 0.9.5 in the last release of Redland.</p>

<p>The Java SiRPAC parsers <code>sirpac-stanford</code>,
<code>sirpac-w3c</code> and the W3C LibWWW parser <code>libwww</code>
have been removed.  Raptor replaces them.</p>


<h3>Serializer Class Changes</h3>

<p>The <a href="docs/api/serializer.html">Serializer</a> class
gained a new method:</p>

<pre>
  int librdf_serializer_serialize_model_to_file(
    librdf_serializer* serializer,
    const char *name,
    librdf_uri* base_uri, 
    librdf_model* model);
</pre>

<p>This writes the serialized model to a filename
(rather than a file handle as done by 
<code>librdf_serializer_serialize_model</code>)
which is easier to use from higher level language APIs until a
cross-language I/O abstraction is available.</p>

<p>The class gained an RDF/XML serializer that can be called
either by the name <code>rdfxml</code> or the
MIME Type <code>application/rdf+xml</code>.  The
examples in each language have been updated to demonstrate
using this.</p>


<h3>Storage Class Changes</h3>

<p>The built in storage factories (<code>memory</code>,
<code>hashes</code>) now both support contexts.  These are enabled by
adding the storage option <code>contexts='yes'</code> to the options
string.  The hashes storage additionally supports indexing predicates
as an extra hash which can be enabled with <code>index-predicates='yes'</code>.
This makes triple queries of the form
(subject unknown, predicate known, object unknown) fast.
</p>

<p>C Example of creating a 0.9.12 storage that does contexts using
on-disk Berkeley/Sleepycat DB:</p>
<pre>
   storage=librdf_new_storage(world,
     "hashes", 
      name,
     "hash-type='bdb',write='yes',new='yes',contexts='yes'");
</pre>


<h3>Stream Class Changes</h3>

<p>The <a href="docs/api/stream.html">Stream</a>
<code>next</code> method was split into <code>get_object</code>
always returning a pointer to a shared Statement and the
<code>next</code> method to advance the iterator.
The <code>get_object</code> method is generally called
<code>current</code> in the higher level language APIs.</p>

<p>(Iterator and Stream now have consistent method names; they
may be merged in future.)</p>


<p>C example for Redland 0.9.11 and earlier:</p>
<pre>
  while(!librdf_stream_end(stream)) {
    statement=(librdf_statement*)librdf_stream_next(stream);
    /* do something with the statement */
  }
</pre>

<p>Redland 0.9.12:</p>
<pre>
  while(!librdf_stream_end(stream)) {
    statement=(librdf_statement*)librdf_stream_get_object(stream);
    /* do something with the statement */
    librdf_stream_next(stream);
  }
</pre>


<p>A new method <code>get_context</code> was added returning a Node
for the context of the Statement.</p>

<p>C Stream context example:</p>
<pre>
  while(!librdf_stream_end(stream)) {
    statement=(librdf_statement*)librdf_stream_get_object(stream);
    context_node=(librdf_node*)librdf_stream_get_context(iterator);
    /* do something with the statement and its context node */
    librdf_stream_next(stream);
  }
</pre>



<h3>Perl Interface Changes</h3>

<p>The <a href="docs/perl.html">Perl</a> interface
moved to the <code>RDF::Redland</code> package (the <code>RDF</code>
namespace was deprecated in 0.9.11).</p>

<p>The interface was updated to receive Redland error and warning
messages callbacks.  These can be set using the
<code>RDF::Redland::set_error_handler</code>
and <code>RDF::Redland::set_warning_handler</code> subroutines
taking a subroutine argument.  They are called with a single
scalar argument which is the Redland message.</p>

<p>The interface was updated to match the Interator and Stream
changes described above.</p>

<p>Perl iterator example for Redland 0.9.11 and earlier:</p>
<pre>
  while(!$iterator->end) {
    my $node=$iterator->next;
    # do something with the node
  }
</pre>

<p>Redland 0.9.12:</p>
<pre>
  while(!$iterator->end) {
    my $node=$iterator->current;
    # do something with the node
    $iterator->next;
  }
</pre>


<p>Perl stream example for Redland 0.9.11 and earlier:</p>
<pre>
  while(!$stream->end) {
    my $statement=$stream->next;
    # do something with the statement
  }
</pre>

<p>Redland 0.9.12:</p>
<pre>
  while(!$stream->end) {
    my $statement=$stream->current;
    # do something with the statement
    $stream->next;
  }
</pre>


<p>Perl example of using the Serializer class:</p>

<pre>
  # Use any rdf/xml parser that is available
  my $serializer=new RDF::Redland::Serializer("rdfxml");
  $serializer->serialize_model_to_file("output.rdf", $uri, $model);
</pre>


<h3>Python API Changes</h3>

<p>The <a href="docs/python.html">Python</a> interface
gained pydoc comments, along with an
<a href="docs/pydoc/RDF.html">HTML derived version</a>.
</p>

<p>The interface was updated to receive Redland error and warning
messages callbacks as python exceptions.  These can be caught
using the standard python try {} catch {} blocks.</p>

<p>The interface was updated to match the Interator and Stream
changes described above.</p>

<p>Python iterator example for Redland 0.9.11 and earlier:</p>
<pre>
  while not iterator.end():
    node=iterator.next()
    # do something with the node
</pre>

<p>Redland 0.9.12:</p>
<pre>
  while not iterator.end():
    node=iterator.current()
    # do something with the node
    iterator.next()
</pre>


<p>Python stream example for Redland 0.9.11 and earlier:</p>
<pre>
  while not stream.end():
    statement=stream.next()
    # do something with the statement
</pre>

<p>Redland 0.9.12:</p>
<pre>
  while not stream.end():
    statement=stream.current()
    # do something with the statement
    stream.next()
</pre>


<p>Python example of using the Serializer class:</p>

<pre>
  # Use any rdf/xml parser that is available
  serializer=RDF.Serializer()
  serializer.serialize_model_to_file("output.rdf", model)
</pre>



<h3>Java Interface Changes</h3>

<p>The <a href="docs/java.html">Java</a> classes were updated to have
a <code>finished()</code> method that the user can call to cleanup
objects replacing the rather useless Java <code>finalize()</code>
method that gives no guarantees to when it is called.</p>

<p>The Java API is still experimental and may change further.</p>


<h2 id="rel_older"><a name="rel_older">Redland 0.9.1 - Redland 0.9.11 Changes</a></h2>

<p>Release notes for 0.9.11 and earlier are in the
<a href="NEWS.html">NEWS page</a> or
<a href="ChangeLog">ChangeLog</a>
</p>



<hr />

<p>Copyright 2003-2004 <a href="http://purl.org/net/dajobe/">Dave Beckett</a>, <a href="http://www.ilrt.bris.ac.uk/">Institute for Learning and Research Technology</a>, <a href="http://www.bristol.ac.uk/">University of Bristol</a></p>

</body>
</html>
