Partially applied upstream

Index: amaya-9.51/Amaya/thotlib/base/platform.c
===================================================================
--- amaya-9.51.orig/Amaya/thotlib/base/platform.c	2006-05-17 19:24:43.701046872 +0100
+++ amaya-9.51/Amaya/thotlib/base/platform.c	2006-05-17 19:25:11.301850912 +0100
@@ -191,6 +191,7 @@
 #endif /* _WX */
 }
 
+#ifndef _WX
 /*----------------------------------------------------------------------
    TtaFileOpen returns: ThotFile_BADHANDLE: error handle:		
   ----------------------------------------------------------------------*/
@@ -249,6 +250,7 @@
 #endif /* _WINGUI */
   return ret;
 }
+#endif
 
 /*----------------------------------------------------------------------
    TtaGetFileSize
Index: amaya-9.51/Amaya/thotlib/document/readprs.c
===================================================================
--- amaya-9.51.orig/Amaya/thotlib/document/readprs.c	2006-05-17 19:25:45.173701608 +0100
+++ amaya-9.51/Amaya/thotlib/document/readprs.c	2006-05-17 19:27:38.743436384 +0100
@@ -241,6 +241,7 @@
 	       return PtVisibility;
 	       break;
 	 }
+	return PtVisibility;
 }
 
 /*----------------------------------------------------------------------
@@ -271,6 +272,7 @@
 	       return PresImmediate;
 	       break;
 	 }
+	return PresImmediate;
 }
 
 /*----------------------------------------------------------------------
@@ -347,6 +349,7 @@
 	       return InheritParent;
 	       break;
 	 }
+	return InheritParent;
 }
 
 /*----------------------------------------------------------------------
Index: amaya-9.51/Amaya/thotlib/content/content.c
===================================================================
--- amaya-9.51.orig/Amaya/thotlib/content/content.c	2006-05-17 19:27:54.456047704 +0100
+++ amaya-9.51/Amaya/thotlib/content/content.c	2006-05-17 19:29:40.217969448 +0100
@@ -860,7 +860,7 @@
 {
   PtrTextBuffer       pBuf, pNextBuf;
   int                 i, j;
-  PolyLinePoint       savePoint, oldSavePoint;
+  PolyLinePoint       savePoint = {0,0}, oldSavePoint={0,0};
   ThotBool            stop;
 
   /* cherche le buffer contenant le point de rang rank */
Index: amaya-9.51/Amaya/thotlib/dialogue/stix.c
===================================================================
--- amaya-9.51.orig/Amaya/thotlib/dialogue/stix.c	2006-05-17 19:30:21.750655520 +0100
+++ amaya-9.51/Amaya/thotlib/dialogue/stix.c	2006-05-17 19:32:09.554266880 +0100
@@ -431,7 +431,7 @@
 void DrawStixIntegral (int frame, int x, int y, int l, int h,
                        int type, int size, int fg)
 {
-  unsigned char   symb;
+  unsigned char   symb = 0x34;
   int             delta;
   ThotFont        font;
 
Index: amaya-9.51/Amaya/thotlib/dialogue/AmayaFileDropTarget.cpp
===================================================================
--- amaya-9.51.orig/Amaya/thotlib/dialogue/AmayaFileDropTarget.cpp	2006-05-17 19:36:41.037995080 +0100
+++ amaya-9.51/Amaya/thotlib/dialogue/AmayaFileDropTarget.cpp	2006-05-17 19:37:03.493581312 +0100
@@ -58,7 +58,6 @@
   View                view;
   int                 frame_id = 0;
   char                buffer[512];
-  ThotBool            found = FALSE;
 
   if (m_pOwner)
     frame_id = m_pOwner->GetFrameId();
Index: amaya-9.51/Amaya/thotlib/dialogue/input.c
===================================================================
--- amaya-9.51.orig/Amaya/thotlib/dialogue/input.c	2006-05-17 19:37:12.451219544 +0100
+++ amaya-9.51/Amaya/thotlib/dialogue/input.c	2006-05-17 19:39:18.730022248 +0100
@@ -1685,7 +1685,10 @@
   char               *appHome;	   /* fichier de translation */
   char                fullName[200];  /* ligne en construction pour motif */
   char                home[200], name[80];
-  char               *addr, *sep = "+";
+  char               *addr;
+#ifndef _WX
+  const char         *sep = "+";
+#endif
   char                transText[MAX_LENGTH], ch[MAX_LENGTH];
   char                equiv[MAX_LENGTH]; /* equivalents caracteres pour motif */
   unsigned int        key1, key2; /* 1ere & 2eme cles sous forme de keysym X */
@@ -1708,9 +1711,6 @@
 
 #ifdef _WINDOWS
   strcat (name, ".kb");
-#ifdef _WX
-  sep = "-"; /* shortcut separator generated by WX */
-#endif /* _WX */
 #endif  /* _WINDOWS */
 #ifdef _UNIX
 #ifdef _MACOS
Index: amaya-9.51/Amaya/annotlib/ANNOTmenu.c
===================================================================
--- amaya-9.51.orig/Amaya/annotlib/ANNOTmenu.c	2006-05-17 19:40:44.995907840 +0100
+++ amaya-9.51/Amaya/annotlib/ANNOTmenu.c	2006-05-17 19:48:25.068966104 +0100
@@ -50,9 +50,11 @@
  ** Local custom query variables
  ************************************************************/
 
+#ifdef _GTK
 static int     CustomQueryBase;
 static ThotBool CustomQueryFlag;
 static char  *AlgaeText;
+#endif
 
 /************************************************************
  ** Local annotation filter variables
@@ -79,6 +81,7 @@
 } TypeSelector;
 
 #ifndef _WINGUI
+#ifdef _GTK
 /*----------------------------------------------------------------------
   CustomQueryCallbackDialog
   callback of the annot custom query menu
@@ -159,6 +162,7 @@
         }
     }
 }
+#endif /* !_GTK */
 #endif /* !_WINGUI */
 
 /*----------------------------------------------------------------------
Index: amaya-9.51/Amaya/thotlib/base/testcase.c
===================================================================
--- amaya-9.51.orig/Amaya/thotlib/base/testcase.c	2006-05-18 22:54:50.022767808 +0100
+++ amaya-9.51/Amaya/thotlib/base/testcase.c	2006-05-18 22:57:10.869355872 +0100
@@ -208,7 +208,7 @@
   FILE *fp = g_benchmark_timer[bench_id].fp;
   if (fp)
     {
-      fprintf (fp, "[%s] Stop timer\tElapsed time=%d ms.\n",
+      fprintf (fp, "[%s] Stop timer\tElapsed time=%ld ms.\n",
 	       g_benchmark_timer[bench_id].name,
 	       (g_benchmark_timer[bench_id].time-g_benchmark_timer[bench_id].start_time)/(CLOCKS_PER_SEC/1000));
       TtaWriteClose(fp);
@@ -236,7 +236,7 @@
   FILE *fp = g_benchmark_timer[bench_id].fp;
   if (fp)
     {
-      fprintf (fp, "[%s] %s\tElapsed time=%d ms\tDelta time=%d ms.\n",
+      fprintf (fp, "[%s] %s\tElapsed time=%ld ms\tDelta time=%ld ms.\n",
 	       g_benchmark_timer[bench_id].name,
 	       mark_name,
 	       (g_benchmark_timer[bench_id].time-g_benchmark_timer[bench_id].start_time)/(CLOCKS_PER_SEC/1000),
Index: amaya-9.51/Amaya/thotlib/base/structlist.c
===================================================================
--- amaya-9.51.orig/Amaya/thotlib/base/structlist.c	2006-05-18 22:57:34.532758488 +0100
+++ amaya-9.51/Amaya/thotlib/base/structlist.c	2006-05-18 22:59:02.473389480 +0100
@@ -523,7 +523,7 @@
           if (pNode->ElStructSchema->SsName == NULL)
             fprintf (fileDescriptor, " Name=NULL");
           else
-            fprintf (fileDescriptor, "(%s %x)", pNode->ElStructSchema->SsName,
+            fprintf (fileDescriptor, "(%s %lx)", pNode->ElStructSchema->SsName,
                      (unsigned long int)pNode->ElStructSchema);
         }
       /* ecrit l'URI associee au schema de structure */
