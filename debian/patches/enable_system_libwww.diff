Index: amaya-9.51/Amaya/configure.in
===================================================================
--- amaya-9.51.orig/Amaya/configure.in	2006-06-17 17:24:01.860704250 +0100
+++ amaya-9.51/Amaya/configure.in	2006-06-17 17:38:10.813760500 +0100
@@ -710,7 +710,7 @@
 
 # C++ options (-x c++)
 CXX_OPTIONS="-D__cplusplus"
-CXXFLAGS="${CXXFLAGS} -Wall -x c++ ${CXX_OPTIONS}"
+CXXFLAGS="${CXXFLAGS} -Wall ${CXX_OPTIONS}"
 
 # setup LDFLAGS
 # on macosx, specific flags must be set to avoid conflicts with allready installed libwww
@@ -1152,26 +1152,88 @@
   with_dav="yes"
 fi
 if test "$with_dav" = "yes" ; then
-   DAV_OPTIONS=-DDAV
+   CURRENT_PATH="`pwd`"
    DAVDIR="davlib"
-   LIBDAV="libwwwdav"
+   BUILDDAV="WebDAV"
+   AMAYA_DAV_OPTIONS="-DDAV"
+   AMAYA_DAV_INCLUDES="-I$CURRENT_PATH/../davlib/h -I$CURRENT_PATH/../davlib/tree/h -I$CURRENT_PATH/../davlib/f"
+   AMAYA_DAV_LIBS="../davlib/davlib.a"
    WITHDAV="--with-dav" 
    WWWDAV="-lwwwdav" 
 else
    with_dav="no"
-   DAV_OPTIONS=""
    DAVDIR=""
-   LIBDAV=""
+   BUILDDAV=""
+   AMAYA_DAV_OPTIONS=""
+   AMAYA_DAV_INCLUDES=""
+   AMAYA_DAV_LIBS=""
    WITHDAV="" 
    WWWDAV="" 
 fi
 
+AC_SUBST(DAVDIR)
+AC_SUBST(BUILDDAV)
+AC_SUBST(AMAYA_DAV_OPTIONS)
+AC_SUBST(AMAYA_DAV_INCLUDES)
+AC_SUBST(AMAYA_DAV_LIBS)
+
+dnl
+dnl Use of system provided libWWW
+dnl
+AC_ARG_ENABLE(system-libwww,       [  --enable-system-libwww try the libWWW system library ])
+
+if test "$enable_system_libwww" = "yes" ; then
+  AC_PATH_PROG(LIBWWWCONFIG, [libwww-config])
+  if test -z "$LIBWWWCONFIG" ; then
+    enable_system_libwww="no"
+  fi
+fi
+
+if test "$enable_system_libwww" != "yes" ; then
+  # configure libwww
+  LIBWWW="libwww"
+  CURRENT_PATH="`pwd`"
+  mkdir libwww
+  cd libwww && \
+    $CURRENT_PATH/../../libwww/configure \
+    --build=$build_alias --host=$host_alias --target=$target_alias \
+    --disable-shared \
+    $WITHDAV \
+    --with-zlib && \
+    echo "libwww is configured" ; \
+    echo "patching wwwconf.h because appkit.h do not compile on macos, and it seems that appkit.h is not used in amaya" ; \
+    cp wwwconf.h wwwconf.h.orig ; \
+    sed -e "s/\(\#define HAVE_APPKIT_APPKIT_H 1\)/\/* \1 *\//" \
+			wwwconf.h.orig > wwwconf.h ; \
+    echo "wwwconf.h patched !" ; \
+  cd -
+  chmod +x libwww/libwww-config
+  BUILDLIBWWW="libWWW"
+  LIBWWWCONFIG="libwww/libwww-config"
+  LIBWWW_LDFLAGS="-L$CURRENT_PATH/libwww/Library/src/.libs -L$CURRENT_PATH/libwww/modules/md5/.libs -L$CURRENT_PATH/libwww/modules/expat/.libs"
+  LIBWWW_CFLAGS="-I$CURRENT_PATH/../../libwww/Library/src -I$CURRENT_PATH/libwww"
+else
+  LIBWWW=""
+  LIBWWW_CFLAGS="$LIBWWW_CFLAGS `$LIBWWWCONFIG --cflags`"
+fi
+
+LIBWWW_CXXFLAGS="$LIBWWW_CFLAGS"
+LIBWWW_LDFLAGS="$LIBWWW_LDFLAGS `$LIBWWWCONFIG --libs`"
+
+AC_SUBST(LIBWWW)
+AC_SUBST(BUILDLIBWWW)
+AC_SUBST(LIBWWW_CFLAGS)
+AC_SUBST(LIBWWW_CXXFLAGS)
+AC_SUBST(LIBWWW_LDFLAGS)
+
 
 if test "$build_amaya" = "yes" ; then
     if test ! -f $srcdir/../libwww/Makefile.in ; then
+      if test "$enable_system_libwww" != "yes"; then
 	AC_MSG_WARN(libwww sources not found !!)
 	AC_MSG_WARN(Disabling Amaya build !)
 	build_amaya="no"
+      fi
     fi
 
     if test ! -f $srcdir/amaya/MathML.S ; then
@@ -1202,7 +1264,6 @@
 
     if test "$with_redland" = "yes" -a "$with_annot" = "no" -a "$with_bookmarks" = "no"; then
        AC_MSG_WARN(Disabling redland as neither annotations nor bookmarks are enabled !)
-       MAKERAPTOR=['#']
        with_raptor="no"
     fi
 
@@ -1300,7 +1361,10 @@
 	    AC_MSG_WARN(Disabling WebDAV build !)
 	    with_dav="no"
             DAVDIR=""
-            LIBDAV=""
+            BUILDDAV=""
+            AMAYA_DAV_OPTIONS=""
+            AMAYA_DAV_INCLUDES=""
+            AMAYA_DAV_LIBS=""
             WITHDAV="" 
             WWWDAV="" 
 	fi
@@ -1409,12 +1473,8 @@
 AC_SUBST(EXTRA_LIBS)
 AC_SUBST(EXTRA_INCLUDES)
 
-AC_SUBST(DAVDIR)
-AC_SUBST(LIBDAV)
-AC_SUBST(WITHDAV)
 AC_SUBST(WWWDAV)
 
-AC_SUBST(MAKERAPTOR)
 AC_SUBST(MAKEREDLAND)
 AC_SUBST(ANNOTLIB_COMPILE_BM)
 AC_SUBST(AMAYA_RAPTOR_SRC)
@@ -1437,9 +1497,6 @@
     plugin_frag=/dev/null
 fi
 
-    AC_SUBST_FILE(www_frag)
-    www_frag=$srcdir/amaya/Makefile.libwww
-
 if test "$with_math" = "no" ; then
     AC_SUBST_FILE(math_frag)
     math_frag=/dev/null
@@ -1464,14 +1521,6 @@
     annot_frag=/dev/null
 fi
 
-if test "$with_dav" = "yes" ; then
-    AC_SUBST_FILE(dav_frag)
-    dav_frag=$srcdir/davlib/Makefile.dav
-else
-    AC_SUBST_FILE(dav_frag)
-    dav_frag=/dev/null
-fi
-
 if test "$with_templates" = "yes" ; then
     AC_SUBST_FILE(templates_frag)
     templates_frag=$srcdir/amaya/Makefile.templates
@@ -1500,8 +1549,11 @@
 if test "$build_amaya" = "yes" ; then
 
     make_output="$make_output amaya/Makefile pluginlib/Makefile"
-    EXTRA_MAKEFILE_IN="$srcdir/amaya/Makefile.in \
-    $srcdir/amaya/Makefile.libwww"
+    EXTRA_MAKEFILE_IN="$srcdir/amaya/Makefile.in"
+
+    if test "enable_system_libwww" != "yes" ; then
+       EXTRA_MAKEFILE_IN="$EXTRA_MAKEFILE_IN $srcdir/amaya/Makefile.libwww"
+    fi
 
     if test "$with_plugin" = "yes" ; then
        make_output="$make_output pluginlib/Makefile"
@@ -1564,7 +1616,11 @@
 
 if test "$build_amaya" = "yes" ; then
     echo Amaya $AMAYA_VER configured
-    echo Amaya configured with libWWW
+    if test "$enable_system_libwww" != "yes" ; then
+        echo Amaya configured with libWWW \(local source\)
+    else
+        echo Amaya configured with libWWW \(system\)
+    fi
     if test "$with_plugin" = "yes" ; then
         echo Amaya configured with Plugins support
     fi
Index: amaya-9.51/Amaya/Options.in
===================================================================
--- amaya-9.51.orig/Amaya/Options.in	2006-06-17 17:24:01.872705000 +0100
+++ amaya-9.51/Amaya/Options.in	2006-06-17 17:24:38.454991250 +0100
@@ -85,7 +85,6 @@
 
 PRINTIFNOTGL=@PRINTIFNOTGL@
 
-LIBWWW=libwww
 
 
 
Index: amaya-9.51/Amaya/Makefile.in
===================================================================
--- amaya-9.51.orig/Amaya/Makefile.in	2006-06-17 17:24:01.888706000 +0100
+++ amaya-9.51/Amaya/Makefile.in	2006-06-17 17:24:38.462991750 +0100
@@ -11,14 +11,14 @@
 
 include Options
 
-LIBWWW	   = libwww
+LIBWWW	   = @LIBWWW@
 LIBRAPTOR  = libraptor
 REDLAND    = redland
 LIBJPEG	   = libjpeg
 LIBPNG	   = libpng
 
 #MKP: adding davlib
-SUBDIRS	= @SUBDIRS@ tools thotlib batch drawlib indexlib annotlib amaya thot @DAVDIR@
+SUBDIRS	= tools thotlib batch drawlib indexlib annotlib amaya thot @DAVDIR@
 EXTRA_SUBDIRS= misc pluginlib $(LIBRAPTOR) $(REDLAND) $(LIBWWW) $(WX_BUILDDIR) $(GL_BUILDDIR)
 
 prefix = @prefix@
@@ -28,7 +28,7 @@
 
 srcdir	= $(THOTDIR)
 
-default : tools gl @BUILDWXWIDGETS@ thotlib batch amaya_prog @PRINTIFNOTGL@
+default : tools gl @BUILDWXWIDGETS@ thotlib batch @BUILDDAV@ amaya_prog @PRINTIFNOTGL@
 
 amaya : amaya_prog tools thotlib @PRINTIFNOTGL@
 
@@ -51,7 +51,7 @@
 	@(if test -d thotlib ; then cd thotlib ; \
 	  $(MAKE) CC="$(CC)" CFLAGS="$(CFLAGS)" CXX="$(CXX)" CXXFLAGS="$(CXXFLAGS)" all ; fi)
 
-amaya_prog: rebuild force bin/str
+amaya_prog: rebuild force bin/str @BUILDLIBWWW@ @BUILDWXWIDGETS@
 	@(if test -d amaya ; then cd amaya ; \
 	  $(MAKE) CC="$(CC)" CFLAGS="$(CFLAGS)" CXX="$(CXX)" CXXFLAGS="$(CXXFLAGS)" amaya ; fi)
 
@@ -59,6 +59,13 @@
 	@(if test -d "$(WX_BUILDDIR)" ; then cd "$(WX_BUILDDIR)" ; \
 	  $(MAKE) ; fi)
 
+libWWW:
+	if test -d "$(LIBWWW)" ; then $(MAKE) -C "$(LIBWWW)"; fi
+
+WebDAV:
+	make -C amaya amaya_schemas
+	if test -d "@DAVDIR@" ; then $(MAKE) -C "@DAVDIR@"; fi
+
 gl: rebuild force
 	@(if test -d "$(GL_BUILDDIR)" ; then cd "$(GL_BUILDDIR)" ; \
 	  $(MAKE) linux-static ; fi)
@@ -168,177 +175,6 @@
 	  COMPTRA="$$bindir/tra" PRINTSTR="$$bindir/printstr" all)
 
 #
-# Rules to rebuild the libWWW package
-#
-
-# MKP: adding libwwwdav
-AMAYA_LIBWWW_STANDARD_LIBS = \
-	libwwwapp \
-	libwwwhttp \
-	libwwwhtml \
-	libwwwmime \
-	libwwwcache \
-	libwwwstream \
-	libwwwfile \
-	libwwwdir \
-	libwwwtrans \
-	libwwwcore \
-	libwwwutils \
-	libwwwftp \
-	@MAKE_LIBWWW_RDF_PARSER@ \
-	libwwwzip \
-        @LIBDAV@
-
-libwww_config :
-	@(if [ ! -d $(THOTDIR)/../$(LIBWWW) ] ; then \
-	      $(ECHO) "Error libwww dir not found at $(THOTDIR)/../$(LIBWWW)" ; \
-	  fi)
-	@(if [ ! -d $(LIBWWW) ] ; then \
-		$(MKDIR) $(LIBWWW) ; \
-          fi)
-#MKP: adding --with-dav
-	@(localdir=`pwd` ; libwwwdir="$$localdir/../../$(LIBWWW)" ; \
-	  cd $(LIBWWW) ; unset LANG; \
-	  if [ ! -f Makefile -o ! -f wwwconf.h ] ; then \
-	  	$$libwwwdir/configure \
-			--build=@build_alias@ --host=@host_alias@ --target=@target_alias@ \
-			--disable-shared \
-			@WITHDAV@ \
-			--with-zlib; \
-		$(ECHO) "libwww is configured" ; \
-		$(ECHO) "patching wwwconf.h because appkit.h do not compile on macos, and it seems that appkit.h is not used in amaya" ; \
-		$(CP) wwwconf.h wwwconf.h.orig ; \
-		$(SED) "s/\(\#define HAVE_APPKIT_APPKIT_H 1\)/\/* \1 *\//" \
-			wwwconf.h.orig > wwwconf.h ; \
-                $(ECHO) "wwwconf.h patched !" ; \
-	  fi)
-
-libwww_make_module_md5 \
-libmd5 : force
-		@(localdir=`pwd`; \
-		 cd $(LIBWWW)/modules/md5 ; \
-		 $(MAKE) CC="$(CC)" CFLAGS="$(CFLAGS) $(EXPAT_OPTIONS)" \
-		 CPPFLAGS="$(CPPFLAGS) $(THOTINCLUDES) $(EXTRA_INCLUDES)" \
-	        	    libmd5.la)
-
-libwww_install_module_md5 : force
-		@(if [ -e libmd5.a -a ! -L libmd5.a ] ; then \
-			$(RM) libmd5.a ; \
-		  fi ; \
-		  if [ ! -L libmd5.a ] ; then \
-			$(LN_S) $(LIBWWW)/modules/md5/.libs/libmd5.a ./libmd5.a ; \
-		  fi)
-
-libwww_make_module_expat \
-libexpat : force
-		@(localdir=`pwd`; \
-		  cd $(LIBWWW)/modules/expat/ ; \
-		  $(MAKE) CC="$(CC)" CFLAGS="$(CFLAGS) $(EXPAT_OPTIONS) -DXML_AMAYA" \
-		  CPPFLAGS="$(CPPFLAGS)" \
-	        	    )
-
-libwww_install_module_expat : force
-		@(if [ -e libexpat.a -a ! -L libexpat.a ] ; then \
-			$(RM) libexpat.a ; \
-		  fi ; \
-		  if [ ! -L libexpat.a ] ; then \
-			$(LN_S) $(LIBWWW)/modules/expat/.libs/libexpat.a ./libexpat.a ; \
-		  fi)
-
-#libwww_make_module_idn \
-#libidn : force
-#		@(localdir=`pwd`; \
-#		  cd $(LIBWWW)/modules/idn/ ; \
-#		  $(MAKE) CC="$(CC)" CFLAGS="$(CFLAGS) $(EXPAT_OPTIONS) -DLIBWWW_USEIDN" \
-#		  CPPFLAGS="$(CPPFLAGS)" \
-#	        	    )
-
-#libwww_install_module_idn : force
-#		@(if [ -e libidn.a -a ! -L libidn.a ] ; then \
-#			$(RM) libidn.a ; \
-#		  fi ; \
-#		  if [ ! -L libidn.a ] ; then \
-#			$(LN_S) $(LIBWWW)/modules/idn/.libs/libidn.a ./libidn.a ; \
-#		  fi)
-
-libwww_make_standard_libs \
-$(AMAYA_LIBWWW_STANDARD_LIBS) : force
-		@(localdir=`pwd`; \
-		  all_libs="" ; \
-		  for lib in $(AMAYA_LIBWWW_STANDARD_LIBS) ; do \
-		      all_libs="$$all_libs $$lib.la" ; \
-		   done ; \
-		  cd $(LIBWWW)/Library/src ; \
-		  $(MAKE) CC="$(CC)" CFLAGS="$(CFLAGS) $(EXPAT_OPTIONS)" \
-		  CPPFLAGS="$(CPPFLAGS) $(THOTINCLUDES) $(EXTRA_INCLUDES)" \
-			     $$all_libs)
-
-libwww_install_standard : force
-		@(for lib in $(AMAYA_LIBWWW_STANDARD_LIBS) ; do \
-		    if [ -e $$lib.a -a ! -L $$lib.a ] ; then \
-			$(RM) $$lib.a ;  \
-		    fi ; \
-		    if [ ! -L $$lib.a ] ; then \
-			$(LN_S) $(LIBWWW)/Library/src/.libs/$$lib.a ./$$lib.a ; \
-		    fi ; \
-		done)
-
-#libwww_make_module_libs : libwww_make_module_md5 libwww_make_module_expat libwww_make_module_idn
-libwww_make_module_libs : libwww_make_module_md5 libwww_make_module_expat
-libwww_make : libwww_make_module_libs libwww_make_standard_libs
-#libwww_install_modules : libwww_install_module_md5 libwww_install_module_expat libwww_install_module_idn
-libwww_install_modules : libwww_install_module_md5 libwww_install_module_expat
-libwww_install : libwww_install_modules libwww_install_standard 
-
-libwww : libwww_config libwww_make
-		@($(ECHO) "libwww is installed")
-
-#
-# Rules to build the raptor RDF package
-#
-
-libraptor_config: @MAKERAPTOR@ force
-	@(if [ ! -e "$(THOTDIR)/$(LIBRAPTOR)" ] ; then \
-	      $(ECHO) "Error raptor dir not found at $(THOTDIR)/$(LIBRAPTOR)" ; \
-	  fi)
-	@(if [ ! -e "$(THOTDIR)/$(LIBRAPTOR)/expat" ] ; then \
-	      libwwwdir="$(THOTDIR)/../$(LIBWWW)" ; \
-	      echo $$libwwwdir ; \
-	      $(LN_S) "$$libwwwdir/modules/expat" "$(THOTDIR)/$(LIBRAPTOR)/expat" ; \
-	  fi)
-	 @(if [ ! -d "$(LIBRAPTOR)" ] ; then \
-		$(MKDIR) $(LIBRAPTOR) ; \
-          fi)
-	 @(localdir=`pwd` ; raptordir="$$localdir/../$(LIBRAPTOR)" ; \
-	  cd $(LIBRAPTOR) ; unset LANG; \
-	  if [ ! -f Makefile -o ! -f config.h ] ; then \
-	  	CFLAGS="-I$$raptordir/expat/lib" \
-			$$raptordir/configure \
-			--build=@build_alias@ --host=@host_alias@ --target=@target_alias@ \
-			--without-shared \
-			--with-expat ; \
-		$(ECHO) "patching libraptor/libtool because -flat_namespace option is missing and do not compile on macosx" ; \
-		$(CP) libtool libtool.orig ; \
-		$(SED) "s/\(allow_undefined_flag=\"-undefined suppress\)/\1 -flat_namespace/" \
-			libtool.orig > libtool ; \
-		$(ECHO) "libraptor/libtool patched !" ; \
-		$(ECHO) "libraptor is configured" ; \
-	  fi)
-
-libraptor_make: @MAKERAPTOR@ force
-	@(localdir=`pwd`; \
-	  cd $(LIBRAPTOR) ; \
-	  if [ ! -e .libs/libraptor.a -a -e libraptor.la ] ; then \
-             $(RM) libraptor.la ; \
-          fi ; \
-	  $(MAKE) CC="$(CC)" CFLAGS="$(CFLAGS) -I$$localdir/../$(LIBRAPTOR)/expat/lib " \
-		  CPPFLAGS="$(CPPFLAGS)" \
-	)
-
-libraptor: @MAKERAPTOR@ libraptor_config libraptor_make
-	@($(ECHO) "libraptor is installed")
-
-#
 # Rules to build the redland RDF library
 #
 
Index: amaya-9.51/Amaya/amaya/Makefile.libwww
===================================================================
--- amaya-9.51.orig/Amaya/amaya/Makefile.libwww	2006-06-17 17:24:01.904707000 +0100
+++ /dev/null	1970-01-01 00:00:00.000000000 +0000
@@ -1,56 +0,0 @@
-#
-# Makefile.libwww
-# Autoconf Fragment when using libWWW
-# Authors: 
-#    Daniel Veillard, 1997 
-#    Jose Kahan, 1999 : dependency extensions, use of a lite libwww
-
-
-AMAYA_LIBWWW_OPTIONS=
-
-AMAYA_LIBWWW_OBJ= \
-	AHTBridge.o \
-	AHTFWrite.o \
-	answer.o \
-	query.o \
-	AHTMemConv.o \
-	AHTInit.o
-
-AMAYA_LIBWWW_OPTION_LIBS=
-
-#MKP: added -lwwwdav
-AMAYA_LIBWWW_LIBS= \
-		-L../$(LIBWWW)/Library/src/.libs \
-			-lwwwapp \
-			-lwwwhttp \
-			$(LIBWWW_RDF_PARSER) \
-			-lwwwhtml \
-			-lwwwmime \
-			-lwwwcache \
-			-lwwwstream \
-			-lwwwfile \
-			-lwwwdir \
-			-lwwwtrans \
-			-lwwwcore \
-			-lwwwutils \
-			-lwwwzip \
-			-lwwwftp \
-			$(WWWDAV) \
-		-L../$(LIBWWW)/modules/md5/.libs \
-			-lmd5 \
-			../$(LIBWWW)/modules/expat/.libs/libexpat.a
-#		-L../$(LIBWWW)/modules/expat/.libs \
-#			-lexpat \
-
-AMAYA_LIBWWW_EXTRA_LIBS=
-
-AMAYA_LIBWWW_INCLUDES= -I../libwww \
-		-I$(THOTDIR)/../libwww/Library/src \
-		-I$(THOTDIR)../libwww/modules/md5 \
-		-I$(THOTDIR)/../libwww/modules/expat/lib
-
-# this dependency calls the ../Makefile rule that compiles libwww
-AMAYA_LIBWWW_SRC= $(LIBZ) amaya_comp_libwww
-
-amaya_comp_libwww : force
-		@(cd .. ; $(MAKE) libwww)
Index: amaya-9.51/Amaya/amaya/Makefile.in
===================================================================
--- amaya-9.51.orig/Amaya/amaya/Makefile.in	2006-06-17 17:24:01.956710250 +0100
+++ amaya-9.51/Amaya/amaya/Makefile.in	2006-06-17 17:24:38.554997500 +0100
@@ -6,10 +6,16 @@
 
 @VPATHOPT@= @srcdir@
 THOTDIR = @top_srcdir@
-WWWDAV = @WWWDAV@
 LIBWWW_RDF_PARSER = @LIBWWW_RDF_PARSER@
 LIBZ = @LIBZ@
 
+AMAYA_LIBWWW_LIBS = @LIBWWW_LDFLAGS@ @WWWDAV@
+AMAYA_LIBWWW_INCLUDES = @LIBWWW_CFLAGS@
+
+AMAYA_DAV_LIBS = @AMAYA_DAV_LIBS@
+AMAYA_DAV_OPTIONS = @AMAYA_DAV_OPTIONS@
+AMAYA_DAV_INCLUDES = @AMAYA_DAV_INCLUDES@
+
 OBJDIRS = wxdialog
 
 include ../Options
@@ -88,10 +94,6 @@
 ../tools/mkdep/mkdep : 
 	@(cd ../tools/mkdep ; $(MAKE) CC="$(CC)" CFLAGS="-O -x c")
 
-#../libraptor/.libs/libraptor.a \
-#amaya_comp_libraptor: @MAKERAPTOR@ force
-#	@(cd .. ; $(MAKE) libraptor CC="$(CC)" CFLAGS="-O2 -x c")
-
 ../redland/librdf/.libs/librdf.a \
 ../redland/raptor/.libs/libraptor.a \
 amaya_comp_redland: @MAKEREDLAND@ force
@@ -109,8 +111,13 @@
 #include the fragment "pluginlib/Makefile.plugin" for plugins if configured in
 @plugin_frag@
 
-#include the fragment "amaya/Makefile.libwww" for libwww if configured in
-@www_frag@
+AMAYA_LIBWWW_OBJ= \
+	AHTBridge.o \
+	AHTFWrite.o \
+	answer.o \
+	query.o \
+	AHTMemConv.o \
+	AHTInit.o
 
 #include the fragment "amaya/Makefile.svg" for svg if configured in
 @svg_frag@
@@ -121,9 +128,6 @@
 #include the fragment "annotlib//Makefile.annot" for annotations if configured in
 @annot_frag@
 
-#include the fragment "davlib/Makefile.dav" for webdav if configured in
-@dav_frag@
-
 #include the fragment "amaya/Makefile.templates" for templates if configured in
 @templates_frag@
 
Index: amaya-9.51/Amaya/annotlib/Makefile.in
===================================================================
--- amaya-9.51.orig/Amaya/annotlib/Makefile.in	2006-06-17 17:24:02.008713500 +0100
+++ amaya-9.51/Amaya/annotlib/Makefile.in	2006-06-17 17:24:38.599000250 +0100
@@ -14,9 +14,8 @@
 
 INCLUDES= -DHAVE_CONFIG_H -DANNOTATIONS \
 	  -I.. -I../amaya  -I@srcdir@/f -I@top_srcdir@/amaya \
-	  -I@top_srcdir@/amaya/f -I../libwww \
-	  -I@top_srcdir@/../libwww/Library/src \
-	  -I@top_srcdir@/../libwww/modules/expat/lib \
+	  -I@top_srcdir@/amaya/f \
+	  @LIBWWW_CFLAGS@ \
 	   @AMAYA_RAPTOR_INCLUDES@ @THOTINCLUDES@ $(GUI_INCLUDES)
 
 
Index: amaya-9.51/Amaya/amaya/Makefile.svg
===================================================================
--- amaya-9.51.orig/Amaya/amaya/Makefile.svg	2006-06-17 17:24:01.972711250 +0100
+++ amaya-9.51/Amaya/amaya/Makefile.svg	2006-06-17 17:24:38.639002750 +0100
@@ -31,7 +31,7 @@
 	$(AMAYA)/Timeline.S $(AMAYA)/TimelineP.P $(AMAYA)/TimelineT.T
 
 svg_schema= compSVG compSVGP compSVGT \
-	compTimeline compTimelineP compTimelineT
+	compTimeline compTimelineP compTimelineT SVG.h
 
 
 #
Index: amaya-9.51/Amaya/amaya/Makefile.math
===================================================================
--- amaya-9.51.orig/Amaya/amaya/Makefile.math	2006-06-17 17:24:01.992712500 +0100
+++ amaya-9.51/Amaya/amaya/Makefile.math	2006-06-17 17:24:38.647003250 +0100
@@ -23,7 +23,7 @@
 
 MATH_SCHEMAS= $(AMAYA)/MathML.S $(AMAYA)/MathMLP.P $(AMAYA)/MathMLT.T
 
-math_schema= compMATH compMATHP compMATHT
+math_schema= compMATH compMATHP compMATHT MathML.h
 
 #
 # Structure schema compilation.
Index: amaya-9.51/Amaya/davlib/Makefile.in
===================================================================
--- amaya-9.51.orig/Amaya/davlib/Makefile.in	2006-06-17 17:24:02.032715000 +0100
+++ amaya-9.51/Amaya/davlib/Makefile.in	2006-06-17 17:24:38.735008750 +0100
@@ -13,46 +13,21 @@
 
 INCLUDES =-DHAVE_CONFIG_H -I.. \
 	  -I../amaya -I@srcdir@/f -I@top_srcdir@/amaya \
-	  -I@top_srcdir@/amaya/f -I../libwww \
+	  -I@top_srcdir@/amaya/f \
 	  -I@top_srcdir@/thotlib/include \
-	  -I@top_srcdir@/../libwww/Library/src \
-	  -I@top_srcdir@/../libwww/modules/expat/lib \
+	  @LIBWWW_CFLAGS@ \
 	  -I$(DAVLIB)/tree/h -I$(DAVLIB)/h \
 	  $(GUI_INCLUDES)
 
 OPTIONS	= @AMAYA_OPTIONS@ $(AMAYA_DAV_OPTIONS)
 
-LIBWWW_LIBS= \
-		-L../$(LIBWWW)/Library/src/.libs \
-			-lwwwapp \
-			-lwwwhttp \
-			-lwwwxml \
-			-lwwwhtml \
-			-lwwwmime \
-			-lwwwcache \
-			-lwwwstream \
-			-lwwwfile \
-			-lwwwdir \
-			-lwwwtrans \
-			-lwwwcore \
-			-lwwwutils \
-			-lwwwzip \
-			-lwwwftp \
-			-lwwwdav \
-		-L../$(LIBWWW)/modules/md5/.libs \
-			-lmd5 \
-		-L../$(LIBWWW)/modules/expat/.libs \
-			-lexpat \
-		-ldl -L/usr/lib
-
-
 prefix = @prefix@
 exec_prefix = @exec_prefix@
 libdir = @libdir@
 
 ############################################
 
-all : tree awparser.o AHTLockBase.o HTHome dav_obj davlib.a
+all : tree awparser.o AHTLockBase.o dav_obj davlib.a
 
 dav_obj : $(AMAYA_DAV_OBJ)
 
@@ -108,8 +83,7 @@
 	awnode.o \
 	awstring.o \
 	awpair.o \
-	list.o \
-	../$(LIBWWW)/Library/src/HTHome.o
+	list.o
 
 #
 # dependencies
